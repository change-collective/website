---
import "../tailwind.css"
import User from "../components/User.astro"
---

<script>
	import { actions } from "astro:actions"
	import { navigate } from "astro:transitions/client"

	let params = new URLSearchParams(document.location.search)
	let redirect = params.get("redirect")
	const redirectUrl = new URL(redirect || "/", document.location.origin)
	console.log("redirect", redirectUrl)

	const form = document.querySelector("form")
	form?.addEventListener("submit", async (event) => {
		event.preventDefault()
		const formData = new FormData(form)
		const { data, error } = await actions.login(formData)
		if (!error) {
			console.log("redirecting to", redirect)
			navigate(redirectUrl.href)
		}
	})
</script>

<body class="flex h-screen items-center justify-center bg-gray-100 font-sans">
	<div class="w-full max-w-md rounded-lg bg-white p-8 shadow-lg">
		<h2 class="mb-6 text-center text-2xl font-bold">Login</h2>
		<form>
			<div class="mb-4">
				<label
					for="email"
					class="mb-2 block text-sm font-bold text-gray-700"
					>Email</label
				>
				<input
					type="email"
					id="email"
					name="email"
					class="focus:shadow-outline box-border w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none"
					required
				/>
			</div>
			<div class="mb-6">
				<label
					for="password"
					class="mb-2 block text-sm font-bold text-gray-700"
					>Password</label
				>
				<input
					type="password"
					id="password"
					name="password"
					class="focus:shadow-outline mb-3 box-border w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none"
					required
				/>
			</div>
			<div class="flex items-center justify-between">
				<button
					type="submit"
					class="focus:shadow-outline rounded bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 focus:outline-none"
					>Login</button
				>
			</div>
		</form>
	</div>
</body>
